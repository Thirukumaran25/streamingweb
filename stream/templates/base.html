<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Streaming Star{% endblock %}</title>
    <link rel="icon" href="{% static 'logo.png' %}" type="image/png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Outfit:wght@500;800&display=swap" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background-color: black; color: white; overflow-x: hidden; }
        #navLinks, #userSection { transition: opacity 0.3s ease-in-out; }
        #searchContainer { transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Mobile Breakpoint for Logo Text */
        @media (max-width: 450px) { .logo-text { display: none; } }

        #navSearchInput {
            white-space: nowrap;
            height: 100%;
        }

        /* Force the search bar to stay black/legible when expanded */
        .search-active {
            width: 100% !important;
            opacity: 1 !important;
            color: #000000 !important;
            display: block !important;
            padding-left: 0.5rem;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col">

<div id="mobileMenu" class="fixed inset-0 bg-black z-[70] hidden flex-col pt-20 px-8 transition-all duration-300">
    <button onclick="toggleMobileMenu()" class="absolute top-6 right-6 text-4xl text-white hover:text-[#FFA629] transition">
        <i class='bx bx-x'></i>
    </button>
    <nav class="flex flex-col gap-6 text-xl font-black uppercase tracking-[0.2em]">
        <a href="/" onclick="toggleMobileMenu()" class="{% if request.path == '/' %}text-[#FFA629]{% else %}text-white{% endif %}">Home</a>
        <a href="/movies/" onclick="toggleMobileMenu()" class="{% if '/movies/' in request.path %}text-[#FFA629]{% else %}text-white{% endif %}">Movies</a>
        <a href="/tv-shows/" onclick="toggleMobileMenu()" class="{% if '/tv-shows/' in request.path %}text-[#FFA629]{% else %}text-white{% endif %}">TV Shows</a>
        {% if user.is_authenticated %}
        <a href="/my-list/" onclick="toggleMobileMenu()" class="{% if '/my-list/' in request.path %}text-[#FFA629]{% else %}text-white{% endif %}">My List</a>
        {% endif %}
        <a href="/genres/" onclick="toggleMobileMenu()" class="{% if '/genres/' in request.path %}text-[#FFA629]{% else %}text-white{% endif %}">Genres</a>
        
        <div class="border-t border-white/10 pt-8 mt-4">
            {% if user.is_authenticated %}
                <a href="{% url 'logout' %}" class="flex items-center gap-3 text-red-500"><i class='bx bx-log-out'></i> Logout</a>
            {% else %}
                <div class="flex flex-col gap-4">
                    <a href="{% url 'login' %}" class="text-center border border-white/20 py-3 rounded text-white">Login</a>
                    <a href="{% url 'register' %}" class="bg-[#FFA629] text-black text-center py-3 rounded font-bold">Sign Up</a>
                </div>
            {% endif %}
        </div>
    </nav>
</div>

<header class="w-full border-b border-white/10 px-4 md:px-10 py-4 flex items-center justify-between sticky top-0 bg-black z-50">
    <div class="flex items-center gap-2 md:gap-8 flex-1">
        <div id="navLinks" class="flex items-center gap-8 shrink-0">
            <a href="/" class="flex items-center gap-2 text-[#FFA629] font-bold text-base md:text-lg tracking-tighter italic whitespace-nowrap">
                <img src="{% static 'logo.png' %}" alt="" class="h-6 md:h-8 w-auto" onerror="this.style.display='none'">
                <span class="logo-text">STREAMINGSTAR</span>
            </a>

            <nav class="hidden lg:flex gap-8 text-[11px] font-black uppercase tracking-widest">
                <a href="/" class="transition {% if request.path == '/' %}text-[#FFA629]{% else %}text-gray-300 hover:text-white{% endif %}">Home</a>
                <a href="/movies/" class="transition {% if '/movies/' in request.path %}text-[#FFA629]{% else %}text-gray-300 hover:text-white{% endif %}">Movies</a>
                <a href="/tv-shows/" class="transition {% if '/tv-shows/' in request.path %}text-[#FFA629]{% else %}text-gray-300 hover:text-white{% endif %}">TV Shows</a>
                {% if user.is_authenticated %}
                <a href="/my-list/" class="transition {% if '/my-list/' in request.path %}text-[#FFA629]{% else %}text-gray-300 hover:text-white{% endif %}">My List</a>
                {% endif %}
                <a href="/genres/" class="transition {% if '/genres/' in request.path %}text-[#FFA629]{% else %}text-gray-300 hover:text-white{% endif %}">Genres</a>
            </nav>
        </div>

        <div id="searchContainer" class="relative flex flex-row-reverse items-center w-10 h-10 md:w-12 md:h-12 bg-transparent rounded-full border border-white/10 ml-auto transition-all duration-500 ease-in-out z-50">
            <button id="searchToggle" class="relative text-xl md:text-2xl text-white hover:text-[#FFA629] transition p-2 min-w-[40px] z-30">
                <i class='bx bx-search' id="searchIcon"></i>
            </button>
            
            <input type="text" id="navSearchInput" placeholder="SEARCH TITLES..."
            class="relative bg-transparent border-none outline-none text-black text-[12px] md:text-sm font-bold uppercase tracking-widest 
            w-0 opacity-0 transition-all duration-500 placeholder-gray-500 italic flex-1 min-w-0 z-20">

            <div id="navSearchResults" class="absolute top-full right-0 mt-4 w-[85vw] md:w-[500px] bg-zinc-900 border border-white/10 rounded-xl shadow-2xl hidden overflow-hidden max-h-[70vh] overflow-y-auto no-scrollbar z-[100]">
                <div id="navResultsList"></div>
            </div>
        </div>
    </div>

    <div id="userSection" class="flex items-center gap-2 md:gap-4 ml-2 shrink-0">
        {% if user.is_authenticated %}
            <div class="relative" id="profileDropdown">
                <button onclick="toggleProfileMenu()" class="flex items-center gap-1 focus:outline-none p-1 rounded-lg hover:bg-white/5 transition">
                    <div class="w-8 h-8 rounded-full bg-red-500 text-white flex items-center justify-center font-bold uppercase text-xs">
                        {{ user.username|slice:":1" }}
                    </div>
                    <i class='bx bx-chevron-down text-gray-400 text-sm'></i>
                </button>
                <div id="profileMenu" class="absolute right-0 mt-3 w-48 bg-zinc-900 border border-white/10 rounded-xl shadow-2xl hidden overflow-hidden">
                    <a href="/profile/" class="flex items-center gap-3 px-4 py-3 text-xs font-bold text-white hover:bg-zinc-800 transition"><i class='bx bx-user'></i> PROFILE</a>
                    <a href="/subscription/" class="flex items-center gap-3 px-4 py-3 text-xs font-bold hover:bg-zinc-800 transition">
                        <i class='bx bx-credit-card text-white text-lg'></i> 
                        <span class='text-white'>SUBSCRIPTION</span>
                    </a>
                    <a href="{% url 'logout' %}" class="flex items-center gap-3 px-4 py-3 text-xs font-bold text-red-400 hover:bg-zinc-800 transition border-t border-white/5"><i class='bx bx-log-out'></i> LOGOUT</a>
                </div>
            </div>
        {% else %}
            <div class="hidden sm:flex items-center gap-4">
                <a href="{% url 'login' %}" class="text-[10px] font-bold uppercase text-gray-300 hover:text-white tracking-widest">Login</a>
                <a href="{% url 'register' %}" class="bg-[#FFA629] text-black px-5 py-2 rounded font-black text-[10px] uppercase tracking-widest transition">Sign Up</a>
            </div>
        {% endif %}

        <button onclick="toggleMobileMenu()" class="lg:hidden text-3xl text-white hover:text-[#FFA629] transition p-1">
            <i class='bx bx-menu'></i>
        </button>
    </div>
</header>

<main class="flex-grow">
  {% block content %}{% endblock %}
</main>

<footer class="px-6 md:px-12 py-20 border-t border-white/5 bg-black">
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-10 text-[11px] text-gray-400 uppercase font-bold tracking-widest">
        <div>
            <h4 class="text-white mb-6 font-black">Company</h4>
            <ul class="space-y-3">
                <li class="hover:text-white cursor-pointer transition">About</li>
                <li class="hover:text-white cursor-pointer transition">Career</li>
                <li class="hover:text-white cursor-pointer transition">Our Culture</li>
                <li class="hover:text-white cursor-pointer transition">Giving</li>
                <li class="hover:text-white cursor-pointer transition">Press room</li>
                <li class="hover:text-white cursor-pointer transition">Partners</li>
                <li class="hover:text-white cursor-pointer transition">Gear</li>
                <li class="hover:text-white cursor-pointer transition">The Blog</li>
                <li class="hover:text-white cursor-pointer transition">Advertise us</li>
            </ul>
        </div>

        <div>
            <h4 class="text-white mb-6 font-black">Go Premium</h4>
            <ul class="space-y-3">
                <li class="hover:text-white cursor-pointer transition">Plans</li>
                <li class="hover:text-white cursor-pointer transition">SS Labs</li>
                <li class="hover:text-white cursor-pointer transition">Get perks</li>
            </ul>
        </div>

        <div>
            <h4 class="text-white mb-6 font-black">Downloads</h4>
            <ul class="space-y-3">
                <li class="hover:text-white cursor-pointer transition">SS Media</li>
                <li class="hover:text-white cursor-pointer transition">Server</li>
                <li class="hover:text-white cursor-pointer transition">SS photos</li>
                <li class="hover:text-white cursor-pointer transition">SS Dash</li>
                <li class="hover:text-white cursor-pointer transition">Where to watch</li>
            </ul>
        </div>

        <div>
            <h4 class="text-white mb-6 font-black">Support</h4>
            <ul class="space-y-3">
                <li class="hover:text-white cursor-pointer transition">Finding Help</li>
                <li class="hover:text-white cursor-pointer transition">Support Help</li>
                <li class="hover:text-white cursor-pointer transition">Community</li>
                <li class="hover:text-white cursor-pointer transition">Forums</li>
                <li class="hover:text-white cursor-pointer transition">Guidelines</li>
                <li class="hover:text-white cursor-pointer transition">Billing</li>
                <li class="hover:text-white cursor-pointer transition">Status</li>
                <li class="hover:text-white cursor-pointer transition">Bug Bounty</li>
                <li class="hover:text-white cursor-pointer transition">Get in touch</li>
            </ul>
        </div>

        <div>
            <h4 class="text-white mb-6 font-black">Watch Free</h4>
            <ul class="space-y-3">
                <li class="hover:text-white cursor-pointer transition">Discover on SS</li>
                <li class="hover:text-white cursor-pointer transition">TV Channel finder</li>
                <li class="hover:text-white cursor-pointer transition">What to watch</li>
                <li class="hover:text-white cursor-pointer transition">A24 collection</li>
                <li class="hover:text-white cursor-pointer transition">Movie database</li>
            </ul>
        </div>

        <div>
            <h4 class="text-white mb-6 font-black">Legal</h4>
            <ul class="space-y-3">
                <li class="hover:text-white cursor-pointer transition">About us</li>
                <li class="hover:text-white cursor-pointer transition">Culture</li>
                <li class="hover:text-white cursor-pointer transition">Blogs</li>
                <li class="hover:text-white cursor-pointer transition">Jobs</li>
                <li class="hover:text-white cursor-pointer transition">Terms & Privacy</li>
                <li class="hover:text-white cursor-pointer transition">Help & Support</li>
            </ul>

        </div>



    </div>



    <div class="mt-20 border-t border-white/10 pt-8 flex flex-col items-center gap-8 text-gray-500 text-[10px] uppercase font-bold tracking-widest">

       

        <div class="flex flex-wrap justify-center gap-x-6 gap-y-2 text-center">

            <span>Copyright Â© 2026 Streaming Star</span>

            <span class="hover:text-white cursor-pointer transition">Privacy policy</span>

            <span class="hover:text-white cursor-pointer transition">Ad choices</span>

            <span class="hover:text-white cursor-pointer transition">Accessibility</span>

            <span class="hover:text-white cursor-pointer transition">Manage cookies</span>

        </div>

        <div class="flex gap-8 text-2xl">
            <i class='bx bxl-youtube hover:text-red-600 transition cursor-pointer'></i>
            <i class='bx bxl-yahoo hover:text-purple-600 transition cursor-pointer'></i>
            <i class='bx bxl-amazon hover:text-yellow-500 transition cursor-pointer'></i>
            <i class='bx bxl-tumblr hover:text-blue-800 transition cursor-pointer'></i>
            <i class='bx bxl-facebook-square hover:text-blue-600 transition cursor-pointer'></i>
            <i class='bx bxl-twitter hover:text-sky-400 transition cursor-pointer'></i>

        </div>
    </div>
</footer>

<script>
    function toggleProfileMenu() {
        const menu = document.getElementById('profileMenu');
        menu.classList.toggle('hidden');
    }

    document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('profileDropdown');
        const menu = document.getElementById('profileMenu');
        if (dropdown && !dropdown.contains(event.target)) {
            menu.classList.add('hidden');
        }
    });

    function toggleMobileMenu() {
        const mobileMenu = document.getElementById('mobileMenu');
        mobileMenu.classList.toggle('hidden');
        document.body.style.overflow = mobileMenu.classList.contains('hidden') ? 'auto' : 'hidden';
    }

    const header = document.querySelector('header');
    window.addEventListener('scroll', () => {
        if (window.pageYOffset > 50) {
            header.classList.replace('bg-black', 'bg-black/95');
            header.classList.add('backdrop-blur-md');
        } else {
            header.classList.replace('bg-black/95', 'bg-black');
            header.classList.remove('backdrop-blur-md');
        }
    });

    // Search Logic
    const searchContainer = document.getElementById('searchContainer');
    const searchToggle = document.getElementById('searchToggle');
    const navSearchInput = document.getElementById('navSearchInput');
    const navSearchResults = document.getElementById('navSearchResults');
    const navResultsList = document.getElementById('navResultsList');
    const navLinks = document.getElementById('navLinks');
    const userSection = document.getElementById('userSection');
    
    let isSearchOpen = false;
    let navDebounce;

    searchToggle.addEventListener('click', (e) => {
        if (!isSearchOpen) {
            e.preventDefault();
            navLinks.classList.add('opacity-0', 'pointer-events-none');
            
            searchContainer.classList.add('bg-white', 'px-4');
            if (window.innerWidth < 1024) {
                userSection.classList.add('opacity-0', 'pointer-events-none');
                searchContainer.style.width = "calc(100% - 1rem)";
            } else {
                searchContainer.style.width = "400px";
            }
            
            navSearchInput.classList.remove('opacity-0','w-0');
            navSearchInput.classList.add('w-full','text-black');
            searchToggle.classList.add('text-black');
            searchToggle.classList.remove('text-white');
            
            navSearchInput.focus();
            isSearchOpen = true;
        } else if (navSearchInput.value === "") {
            closeSearchBar();
        }
    });

    function closeSearchBar() {
        navLinks.classList.remove('opacity-0', 'pointer-events-none');
        userSection.classList.remove('opacity-0', 'pointer-events-none');
        
        searchContainer.classList.remove('bg-white','px-4');
        searchContainer.style.width = ""; // Reset to CSS default
        
        navSearchInput.classList.add('opacity-0','w-0');
        navSearchInput.classList.remove('w-full');
        searchToggle.classList.remove('text-black');
        searchToggle.classList.add('text-white');
        
        navSearchInput.value = "";
        navSearchResults.classList.add('hidden');
        isSearchOpen = false;
    }

    document.addEventListener('click', (e) => {
        if (isSearchOpen && !searchContainer.contains(e.target)) {
            closeSearchBar();
        }
    });

    navSearchInput.addEventListener('input', (e) => {
        const query = e.target.value.trim();
        executeSearch(query);
    });

    function executeSearch(query) {
        clearTimeout(navDebounce);
        if (query.length > 1) {
            navDebounce = setTimeout(() => {
                fetch(`/api/search/?q=${query}`)
                .then(res => res.json())
                .then(data => {
                    navSearchResults.classList.remove('hidden');
                    if (data.results && data.results.length > 0) {
                        navResultsList.innerHTML = data.results.map(movie => `
                            <a href="/movies/${movie.imdbID}/" class="flex items-center gap-4 p-4 hover:bg-white/5 transition border-b border-white/5 last:border-0">
                                <img src="${movie.Poster}" class="w-12 h-16 object-cover rounded shadow" onerror="this.src='https://via.placeholder.com/100x150?text=No+Image'">
                                <div class="overflow-hidden text-left">
                                    <p class="text-[11px] font-black text-white uppercase tracking-tighter truncate w-48">${movie.Title}</p>
                                    <p class="text-[9px] text-gray-500 font-bold uppercase">${movie.Year}</p>
                                </div>
                            </a>
                        `).join('');
                    } else {
                        navResultsList.innerHTML = `<p class="p-8 text-[10px] text-center text-gray-500 font-black uppercase tracking-widest">No matching titles</p>`;
                    }
                });
            }, 300);
        } else {
            navSearchResults.classList.add('hidden');
        }
    }
</script>
</body>
</html>