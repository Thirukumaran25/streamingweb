{% extends 'base.html' %}

{% block title %}{{ movie.title }} | Streaming Star{% endblock %}

{% block content %}
<style>
    .detail-vignette {
        background: linear-gradient(to top, #000 0%, transparent 100%),
                    linear-gradient(to right, #000 0%, rgba(0,0,0,0.4) 100%);
    }
</style>

<div class="relative w-full h-[50vh] md:h-[70vh] overflow-hidden">
    {% if movie.backdrop %}
        <img src="{{ movie.backdrop.url }}" class="w-full h-full object-cover object-top opacity-40">
    {% else %}
        <div class="w-full h-full bg-zinc-900 opacity-40"></div>
    {% endif %}
    <div class="absolute inset-0 detail-vignette"></div>
</div>

<div class="max-w-7xl mx-auto px-6 md:px-16 -mt-32 md:-mt-64 relative z-10 pb-24">
    <div class="flex flex-col md:flex-row gap-10 items-start">
        
        <div class="w-64 md:w-80 flex-shrink-0 shadow-2xl rounded-lg overflow-hidden border border-white/10">
            <img src="{{ movie.poster.url }}" alt="{{ movie.title }}" class="w-full h-auto">
        </div>

        <div class="flex-grow pt-4 md:pt-20">
            <h1 class="text-5xl md:text-7xl font-black italic tracking-tighter uppercase mb-2">
                {{ movie.title }}
            </h1>

            {% if movie.director %}
            <p class="text-gray-400 font-bold uppercase tracking-widest text-xs mb-6">
                Director by <span class="text-white ml-2">{{ movie.director }}</span>
            </p>
            {% endif %}

            <div class="flex flex-wrap items-center gap-4 text-[11px] font-black uppercase tracking-widest mb-8">
                {% if movie.year %}<span class="text-gray-300">{{ movie.year }}</span>{% endif %}
                {% if movie.duration %}<span class="text-gray-300">{{ movie.duration }}</span>{% endif %}
                {% if movie.genre %}<span class="text-gray-300">{{ movie.genre }}</span>{% endif %}
                <span class="border border-yellow-500/50 text-yellow-500 px-2 py-0.5 rounded italic">4.9</span>
            </div>

            <div class="flex flex-wrap gap-4 mb-10">
                <button class="bg-yellow-400 hover:bg-yellow-300 text-black font-black px-10 py-4 rounded uppercase text-xs tracking-[0.2em] flex items-center gap-2 transition">
                    <i class='bx bx-play text-2xl'></i> Watch Free
                </button>
                <button class="w-14 h-14 border border-white/20 rounded-full flex items-center justify-center hover:bg-white/10 transition">
                    <i class='bx bx-plus text-2xl'></i>
                </button>
                <button class="w-14 h-14 border border-white/20 rounded-full flex items-center justify-center hover:bg-white/10 transition">
                    <i class='bx bx-bookmark text-2xl'></i>
                </button>
                <button class="w-14 h-14 border border-white/20 rounded-full flex items-center justify-center hover:bg-white/10 transition">
                    <i class='bx bx-download text-2xl'></i>
                </button>
            </div>

            {% if movie.description %}
            <p class="text-gray-400 text-sm md:text-base font-medium leading-relaxed max-w-2xl border-l-2 border-yellow-500/30 pl-6">
                {{ movie.description }}
            </p>
            {% endif %}
        </div>
    </div>

    <div class="mt-24">
        <div class="flex items-center gap-4 mb-10">
            <h2 class="text-xl font-black uppercase tracking-[0.3em]">Cast & Crew</h2>
            <div class="h-[1px] flex-grow bg-white/10"></div>
            <i class='bx bx-chevron-right text-2xl text-gray-600'></i>
        </div>

        <div class="flex flex-wrap gap-8 md:gap-14">
            {% for item in movie.moviecast_set.all %}
            <div class="group text-center w-28 md:w-36">
                <div class="aspect-square rounded-full overflow-hidden mb-4 border-2 border-transparent group-hover:border-yellow-500/50 transition duration-500 grayscale group-hover:grayscale-0">
                    <img src="{{ item.cast.image.url }}" alt="{{ item.cast.real_name }}" class="w-full h-full object-cover">
                </div>
                <h3 class="text-[10px] md:text-xs font-black uppercase tracking-tighter text-white mb-1 truncate">
                    {{ item.cast.real_name }}
                </h3>
                {% if item.character_name %}
                <p class="text-[9px] md:text-[10px] font-bold text-zinc-500 uppercase truncate">
                    {{ item.character_name }}
                </p>
                {% endif %}
            </div>
            {% empty %}
                <p class="text-zinc-600 text-xs font-bold uppercase tracking-widest italic">Cast information not available.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}